#: import threading threading
WindowManager:
    MainScreen:
        id: main
    InventarioScreen:
        id: inventario
    ShapefileScreen:
        id: shapefilescreen
    DownloadScreenShp:
        id: downloadscreen_shp

<MainScreen>:
    name: 'main'
    FloatLayout:
        MapView:
            id: map
            lat: -10
            lon: -50
            zoom: 5
            size_hint: 1, 0.99
        BoxLayout:
            Button:
                text: 'Selecionar Inventario'
                size_hint: 0.2, 0.05
                pos_hint: {'x':0, 'y':0}
                # on_release: root.open_popup()
                on_release:
                    root.change_toInventario()
                    root.manager.transition.direction = 'right'

        # Button:
        #     text: 'Mostrar Inventario'
        #     size_hint: 0.2, 0.05
        #     pos_hint: {'x': 0, 'y':0.05}
        #     on_release:
                # root.show_inventario_cluster()
                # root.executefunc()
                # root.manager.transition.direction = "left"
            # on_release: threading.Thread(target=root.show_inventario_cluster, daemon=True).start()

            Button:
                text: 'Selecionar Shapefile'
                size_hint: 0.2, 0.05
                pos_hint: {'x':0.2, 'y':0}
                # on_release: root.open_popup_shp()
                on_release:
                    root.change_toShape()
                    root.manager.transition.direction = 'left'
        # Button:
        #     text: 'Mostrar Shapefile'
        #     size_hint: 0.2, 0.05
        #     pos_hint: {'x':0.2, 'y':0.05}
        #     on_release: root.check_within_shp()
            # on_release: threading.Thread(target=root.check_within_shp).start()

            Button:
                text: 'Download'
                size_hint: 0.2, 0.05
                pos_hint: {'x':0.4, 'y':0}
                # on_release: root.download_ANA_station()
                on_release:
                    root.change_toDownload_shp()
                    root.manager.transition.direction = 'up'
                # root.show_codes()


<InventarioScreen>:
    name: 'inventario'
    GridLayout:
        rows: 4
        FileChooserListView:
            id: filechooserscreen
            filters: ['*.csv']
            on_submit:
                inventarioPath.text = filechooserscreen.selection[0]
        Label:
            id: inventarioPath
            text: 'Nada selecionado'
        Button:
            text: 'Selecionar'
            on_release:
                # root.teste()
                root.show_inventarioCluster(filechooserscreen.selection)
        Button:
            text: 'Voltar'
            on_release:
                app.root.current='main'
                root.manager.transition.direction = "left"


<ShapefileScreen>:
    name: 'shapefilescreen'
    GridLayout:
        rows: 4
        FileChooserListView:
            id: filechoosershape
            filters: ['*.shp']
            on_submit: shapePath.text = filechoosershape.selection[0]
        Label:
            id: shapePath
            text: 'Nada selecionado'
        Button:
            text: 'Selecionar'
            on_release:
                root.get_codes(filechoosershape.selection)

        Button:
            text: 'Voltar'
            on_release:
                app.root.current = 'main'
                root.manager.transition.direction = 'right'


<DownloadScreenShp>:
    name: 'downloadscreen_shp'
    GridLayout:
        rows: 4
        FileChooserListView:
            id: filechooser_downloadshp
            dirselect: True
            filters: [root.selected]
        Label:
            id: downloadShpPath
            text: 'Nada selecionado'
        Button:
            id: downloadbtn
            on_release:
                root.download_ANA_station()
                # root.teste()
        Button:
            text: 'Voltar'
            on_release:
                app.root.current = 'main'
                root.manager.transition.direction = 'down'




# <CustomPopup>:
#     size_hint: 0.5, 0.5
#     title: "Selecione o arquivo 'Inventario.csv'"
#     FileChooserListView:
#         id: filechooser
#         size_hint: 1,1
#         filters: ['*.csv']
#         on_submit:
#             root.select_inventario(filechooser.selection)

<ShapefilePopup>:
    size_hint: 0.5, 0.5
    title: "Selecione o arquivo Shapefile '*.shp'"
    FileChooserListView:
        id: shapefile_chooser
        size_hint: 1,1
        filters: ['*.shp']
        on_submit:
            root.select_shapefile(shapefile_chooser.selection)
